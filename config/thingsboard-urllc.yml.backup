# ThingsBoard Configuration - Optimized for URLLC
# ================================================
# Configuração otimizada para Ultra-Reliable Low Latency Communication (URLLC)
# Reduz timeouts e delays para atingir latência <1ms

# === RPC TIMEOUT CONFIGURATION ===
# Otimizado para URLLC baseado nos testes: valor funcional que não causa falhas
CLIENT_SIDE_RPC_TIMEOUT: 1000

# === DATABASE BATCH PROCESSING ===
# Otimizado para URLLC baseado nos testes funcionais
SQL_TS_BATCH_MAX_DELAY_MS: 10      # Otimizado para URLLC
SQL_TS_LATEST_BATCH_MAX_DELAY_MS: 5  # Otimizado para URLLC

# === CASSANDRA (LEGACY - MANTIDO PARA COMPATIBILIDADE) ===
CASSANDRA_TS_BATCH_MAX_DELAY_MS: 10
CASSANDRA_TS_LATEST_BATCH_MAX_DELAY_MS: 5

# === PERFORMANCE TUNING ===
# Configurações adicionais para alta performance URLLC
DEFAULT_TOKEN_EXPIRATION_TIME: 10800  # 3 hours
REFRESH_TOKEN_EXPIRATION_TIME: 86400  # 24 hours

# === HTTP CONNECTION POOL OPTIMIZATION ===
# Otimizar connection pool para reduzir latência de RPC calls
HTTP_REQUEST_TIMEOUT_MS: 5000       # Reduzido para URLLC
HTTP_MAX_CONNECTIONS: 400           # Aumentado para mais concorrência
HTTP_MAX_CONNECTIONS_PER_ROUTE: 100 # Aumentado para mais concorrência
HTTP_CONNECTION_TIMEOUT_MS: 1000    # 1s timeout para estabelecer conexão
HTTP_SOCKET_TIMEOUT_MS: 2000        # 2s timeout para socket read

# === THREAD POOL OPTIMIZATION ===
# Mais threads para paralelizar RPC processing (otimizado para URLLC)
ACTORS_SYSTEM_MAX_ACTOR_INIT_ATTEMPTS: 3
ACTORS_SYSTEM_MAX_ACTOR_MAILBOX_SIZE: 2000
TB_QUEUE_CORE_WORKERS: 32              # Aumentado para mais paralelismo
TB_QUEUE_CORE_POLL_INTERVAL_MS: 25     # Reduzido para processamento mais rápido
TB_QUEUE_CORE_PARTITIONS: 8            # Mais partições para melhor distribuição

# === QUEUE OPTIMIZATION ===
# Reduzir delays no processamento de filas
TB_QUEUE_CORE_ADMIN_NOTIFICATION_POLL_INTERVAL_MS: 100
TB_QUEUE_CORE_STATS_PRINT_INTERVAL_MS: 60000

# === MAIL CONFIGURATION (DISABLED) ===
MAIL_ENABLED: false

# === DATABASE CONFIGURATION ===
# Use PostgreSQL por padrão
SPRING_DATASOURCE_DRIVER_CLASS_NAME: org.postgresql.Driver

# === LOGGING ===
# Configuração de log otimizada para debugging de performance
LOGGING_LEVEL_ROOT: INFO
LOGGING_LEVEL_COM_THINGSBOARD: INFO

# === CACHE CONFIGURATION ===
# Otimizar cache para reduzir latência
CACHE_TYPE: caffeine
CACHE_SPECS_RELATIONS: maximumSize=100000,expireAfterWrite=3600s

# === QUEUE CONFIGURATION ===
TB_QUEUE_TYPE: in-memory
TB_QUEUE_IN_MEMORY_STATS_PRINT_INTERVAL_MS: 60000

# === HTTP/HTTPS CONFIGURATION ===
HTTP_ENABLED: true
HTTPS_ENABLED: false
HTTP_BIND_ADDRESS: 0.0.0.0
HTTP_BIND_PORT: 8080

# === MQTT CONFIGURATION ===
MQTT_ENABLED: true
MQTT_BIND_ADDRESS: 0.0.0.0
MQTT_BIND_PORT: 1883
MQTT_TIMEOUT: 5000  # Reduzido para URLLC

# === COAP CONFIGURATION ===
COAP_ENABLED: true
COAP_BIND_ADDRESS: 0.0.0.0
COAP_BIND_PORT: 5683
COAP_TIMEOUT: 10000

# === LWM2M CONFIGURATION ===
LWM2M_ENABLED: false

# === SNMP CONFIGURATION ===
SNMP_ENABLED: false

# === SECURITY ===
SECURITY_ENABLED: true

# === INSTALLATION ===
INSTALL_TB: true
LOAD_DEMO: true

# === JVM CONFIGURATION ===
# Otimizado para URLLC com heap maior e GC otimizado
JAVA_OPTS: "-Xms4G -Xmx12G -XX:+UseG1GC -XX:MaxGCPauseMillis=20 -XX:G1HeapRegionSize=16m -XX:+UseStringDeduplication"